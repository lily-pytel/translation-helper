<!DOCTYPE html5>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <link rel="stylesheet" href="">
    <style type="text/css" media="screen">
        body {
            font-family: sans-serif;
        }

        td, th {
            text-align: center;
        }

        .error-highlight {
            background: yellow;
        }

        .error-highlight-container {
            margin-top: 5px;
            margin-bottom: 5px;
            background: beige;
            direction: rtl;
        }

        #options-section {
            padding: 20px 5px 20px 5px;
            max-width: 150px;
        }

        #options-section button {
            margin-bottom: 5px;
        }

        #hotkeys-info {
            max-width: 260px;
            float: right;
        }

        #common-errors-area {
            padding: 0px 5px 0px 5px;
            max-width: 150px;
        }

        #common-error-select {
            max-width: 160px;
        }

        #fixes-section {
            font-size: 12px;
        }

    </style>
    <script src="jquery.js"></script>
    <script>

var Player = null
var Editor = null
var PlaybackRateControl = null

var LineLength = 29
var SpaceBar = 32
var LeftArrow = 37
var UpArrow = 38
var RightArrow = 39
var DownArrow = 40
var SKey = 83


var Configuration = {
    playbackRate: 1.0,
}

function finalErrorCheck(editor) {
    var matches
    ,   text = editor.val()
    ,   message = '';

    for (var i = 0; i < commonErrors.length; i++) {
        matches = text.match(commonErrors[i].matchWith);

        if (matches) {
            message += "Found <b>" + matches.length + "</b> match(es) for <b>" + commonErrors[i].matchWith + "</b><br>";
        }
    }

    message += "Finished final check";
    $('#fixes-section').html(message);
}

function fixCommonErrors(editor) {
    var text = editor.val()
    ,   message = '';

    for (var i = 0; i < commonErrors.length; i++) {
        text = text.replace(commonErrors[i].matchWith, function(match) {
            message += "Replaced <b>" + match + "</b> with <b>" + commonErrors[i].replaceWith + "</b><br>";
            return commonErrors[i].replaceWith;
        })
    }

    editor.val(text);
    message += "Finished auto fixes";
    $('#fixes-section').html(message);   
}

function seek(videoPlayer, value) {
    var seekToTime = videoPlayer.currentTime + value;
    if( seekToTime < 0 || seekToTime > videoPlayer.duration ) 
        return;

    videoPlayer.currentTime = seekToTime;
}

function saveVideoState(videoPlayer){
    localStorage.videoFile = videoPlayer.currentSrc
    localStorage.videoLocation = videoPlayer.currentTime
    console.log(localStorage.videoLocation)
}

function saveBuffer(editor) {
    localStorage.savedBuffer = editor.val()
}

function saveBufferRecovery(editor) {
    var val = editor.val()
    if(val.trim().length > 1) {
        localStorage.recoveryBuffer = val
    }
}

function loadBuffer(editor) {
    editor.val(localStorage.savedBuffer)
}

function loadVideoState(videoPlayer){
    if (localStorage.videoFile === videoPlayer.src){
        videoPlayer.currentTime = parseFloat(localStorage.videoLocation)
    }
}

function loadBufferFromRecovery(editor) {
    editor.val(localStorage.recoveryBuffer)
}

function clearSavedBuffer() {
    localStorage.saveBuffer = ""
}

function saveConfiguration() {
    localStorage.playbackRate = Configuration.playbackRate
}

function loadConfiguration() {
    var playbackRate = localStorage.playbackRate
    Configuration.playbackRate = (playbackRate === undefined) ? 1.0 : parseFloat(playbackRate)

    applyConfiguration()
}

function applyConfiguration() {
    Player.playbackRate = Configuration.playbackRate
    PlaybackRateControl.val(Player.playbackRate)
}


function tokenize() {
    let text = Editor.val()
    let pattern = /([^\.!\?\n]+[\.!\?\n]+)/g
    let tokens = text.split(pattern)
    let outTokens = []
    let i = 0
    for(let tok of tokens) {
        outTokens.push({text: tok, index: i++})
    }
    return outTokens
}


function serializeTokens(tokens) {
    let strings = []
    for(let tok of tokens) {
        strings.push(tok.text)
    }
    return strings.join("")
}

FIX_VERBOSE = true;

class Fix {
    constructor(matchWith, replaceWith) {
        this.matchWith = matchWith
        this.replaceWith = replaceWith
    }

    fix(text) {
        let self = this
        return text.replace(this.matchWith, function(match) {
            if (FIX_VERBOSE) {
                console.log("replaced " + match + " with " + self.replaceWith);
            }
            return commonErrors[i].replaceWith;
        })
    }

    test(text) {
        matches = text.match(this.matchWith);

        if (matches && FIX_VERBOSE) {
            console.log("Found " + matches.length + " matches for " + this.matchWith);
        }
        return matches
    }

    static build(obj) {
        return new Fix(obj.matchWith, obj.replaceWith)
    }
}

class ErrorTokenManager {
    constructor() {
        this.tokens = tokenize()
    }

    save() {
        Editor.val(serializeTokens(this.tokens))
    }

    findErrorContainingTokens(fixer) {
        let i = 0
        let tokens = []
        let pattern = fixer.matchWith
        for(let tok of this.tokens) {
            if (pattern.test(tok.text)) {
                tokens.push(new ErrorTokenContext(fixer, tok))
            }
            i++
        }
        return tokens
    }

    renderForPattern(pattern){
        let contexts = this.findErrorContainingTokens(pattern)
        let container = $("#error-fix-display-container")
        let self = this
        container.empty()
        for (let ctx of contexts) {
            container.append(ctx.render())
        }
        $("#match-count").html(`${contexts.length} Matches`)

        let commitFixBtn = $("<button>Apply</button>")
        commitFixBtn.click(function() {
            self.save()
            container.empty()
            $("#match-count").html("")
        }).css("margin-top", "3px")
        container.append(commitFixBtn)
    }
}


class ErrorTokenContext {
    constructor(fixer, token){
        this.fixer = fixer
        this.token = token
        this.token.fixedText = token.text
        this.token.doFix = false
        this.token.fixedText = this.token.fixedText.replace(
            fixer.matchWith,
            function(match) {
                return fixer.replaceWith;
            })
        this.element = null
    }

    render() {
        let element = $("<div></div>").addClass("error-highlight-container")
        let self = this
        this.renderInto(element)
        element.click(function(e){
            console.log("Fixing " + self.token.text)
            self.fix()
            self.element.empty()
            self.renderInto(self.element)
        })
        this.element = element
        return element
    }

    renderInto(element) {
        let pattern = new RegExp(
            "(" + this.fixer.matchWith.source + ")",
            this.fixer.matchWith.flags)
        let parts = this.token.text.split(pattern)
        let fmtParts = []
        let i = 0
        let self = this
        while(i < parts.length) {
            fmtParts.push($("<span></span>").html(parts[i++]))
            let highlightSpan = $("<span></span>").addClass("error-highlight").html(parts[i++])
            fmtParts.push(highlightSpan)
            fmtParts.push($("<span></span>").html(parts[i++]))
        }
        element.append(fmtParts)
    }

    fix() {
        if (this.token.doFix) {
            let temp = this.token.text
            this.token.text = this.token.fixedText
            this.token.fixedText = temp
            this.token.doFix = true;
        } else {
            let temp = this.token.text
            this.token.text = this.token.fixedText
            this.token.fixedText = temp
            this.token.doFix = false;
        }
        console.log(this)
    }
}


function initHighlighter() {
    $("#highlight-matches").click(function(){
        let matchWith = $("#fix-pattern").val()
        let replaceWith = $("#replace-with").val()
        matchWith = new RegExp(matchWith, 'g')
        let fixer = new Fix(matchWith, replaceWith)
        let errorManager = new ErrorTokenManager()
        errorManager.renderForPattern(fixer)
    })

    let fixerSelect = $("#common-error-select")
    let i = 0
    for(let fixer of commonErrors) {
        let fixerOpt = $("<option></option>")
        let label = `${fixer.replaceWith} &rarr; ${fixer.matchWith.source}`
        if(label.length > 30) {
            label = label.slice(0, 27) + "..."
        }
        fixerOpt.attr("value", i++)
        fixerOpt.html(label)
        fixerSelect.append(fixerOpt)
    }
    fixerSelect.change(function(e) {
        let index = parseInt(this.value)
        let fixer = commonErrors[index]
        $("#fix-pattern").val(fixer.matchWith.source)
        $("#replace-with").val(fixer.replaceWith)
    })
}


$(function() {
    Player = $("#player video")[0]
    Editor = $("#editor textarea")
    PlaybackRateControl = $("#playback-rate-control")

    PlaybackRateControl.change(function(e) {
        Configuration.playbackRate = parseFloat(this.value)
        saveConfiguration()
        applyConfiguration()
    })

    loadBuffer(Editor)
    loadConfiguration()
    loadVideoState(Player)
    // Main Loop, Dispatching Events on Key
    $(document).keydown(function(e) {
        if (e.ctrlKey) {
            switch (e.keyCode) {
                case SKey: {
                    e.preventDefault()
                    break;
                }
            }
        }
        else if(e.altKey) {
            switch (e.keyCode) {
                case LeftArrow: {
                    seek(Player, -5)
                    break
                }
                case RightArrow: {
                    seek(Player, +5)
                    break
                }
                case DownArrow:
                case UpArrow:
                case SpaceBar: {
                    if(Player.paused) {
                        Player.play()
                    } else {
                        Player.pause()
                    }
                    break
                }

            }
        }
    })

    setInterval(function cacheBufferForRecovery() {
        saveBufferRecovery(Editor)
    }, 1000)

    $(window).on("unload", function(e) {
        saveBuffer(Editor)
        saveConfiguration()
        saveVideoState(Player)
    })

    initHighlighter()
})

var commonErrors = [
    {
        matchWith: /אחות שלך/g,
        replaceWith: "אחותך"
    }, {
        matchWith: /אח שלך/g,
        replaceWith: "אחיך"
    }, {
        matchWith: /אחות שלי/g,
        replaceWith: "אחותי"
    }, {
        matchWith: /משום ש/g,
        replaceWith: "כי "
    }, {
        matchWith: /בגלל ש/g,
        replaceWith: "כי "
    }, {
        matchWith: /בכול מקרה/g,
        replaceWith: "בכל מקרה"
    }, {
        matchWith: /כול הלב/g,
        replaceWith: "כל הלב"
    }, {
        matchWith: /כול לבי/g,
        replaceWith: "כל הלב"
    }, {
        matchWith: /בכול פעם/g,
        replaceWith: "בכל פעם"
    }, {
        matchWith: /בכול מקום/g,
        replaceWith: "בכל מקום"
    }, {
        matchWith: /תסתכל אליי/g,
        replaceWith: "תסתכל עליי"
    }, {
        matchWith: /תסתכלי אליי/g,
        replaceWith: "תסתכלי עליי"
    }, {
        matchWith: /להגיד/g,
        replaceWith: "לומר"
    }, {
        matchWith: /סינטיה/g,
        replaceWith: "סינתיה"
    }, {
        matchWith: /חייגת/g,
        replaceWith: "התקשרת"
    }, {
        matchWith: /חייגת/g,
        replaceWith: "תתקשר"
    }, {
        matchWith: /אגיד/g,
        replaceWith: "אומר"
    }, {
        matchWith: /\.\-/g,
        replaceWith: "\. \-"
    }, {
        matchWith: /\?\-/g,
        replaceWith: "\? \-"
    }, {
        matchWith: /  +/g,
        replaceWith: " "
    }, {
        matchWith: /\n +/g,
        replaceWith: "\n"
    }, {
        matchWith: / +\n/g,
        replaceWith: "\n"
    }, {
        matchWith: /מה זאת אומרת ש/g,
        replaceWith: "מה פתאום "
    }, {
        matchWith: /מה זאת אומרת/g,
        replaceWith: "מה פתאום"
    }, {
        matchWith: /מעולם לא|לעולם לא/g,
        replaceWith: "אף פעם לא"
    }, {
        matchWith: /אלף פעמים/g,
        replaceWith: "אלף פעם"
    }, {
        matchWith: /או שלא\?/g,
        replaceWith: "או לא\?"
    }, {
        matchWith: /אקוגרפיה/g,
        replaceWith: "אולטרה סאונד"
    }, {
        matchWith: /גורלה של אווה/g,
        replaceWith: "הגורל של אווה"
    }, {
        matchWith: /איתך/g,
        replaceWith: "אתך"
    }, {
        matchWith: /איתו/g,
        replaceWith: "אתו"
    }, {
        matchWith: /איתנו/g,
        replaceWith: "אתנו"
    }, {
        matchWith: /עכשיו ש/g,
        replaceWith: "עכשיו כש"
    }, {
        matchWith: /העיקר ש/g,
        replaceWith: "העיקר הוא ש"
    }, {
        matchWith: /האמת ש/g,
        replaceWith: "האמת היא ש"
    }, {
        matchWith: /עדיין אתה/g,
        replaceWith: "אתה עדיין"
    }, {
        matchWith: /עדיין את/g,
        replaceWith: "את עדיין"
    }, {
        matchWith: /עדיין אני/g,
        replaceWith: "אני עדיין"
    }, {
        matchWith: /מסתיים/g,
        replaceWith: "נגמר"
    }, {
        matchWith: /הסתיים/g,
        replaceWith: "נגמר"
    }, {
        matchWith: /די-אן-איי/g,
        replaceWith: 'דנ"א'
    }, {
        matchWith: /כול זה/g,
        replaceWith: "כל זה"
    }, {
        matchWith: /אבוא מיד/g,
        replaceWith: "מיד אבוא"
    }, {
        matchWith: /יום יבוא ו/g,
        replaceWith: "יום אחד "
    }, {
        matchWith: /למותה של/g,
        replaceWith: "למוות של"
    }, {
        matchWith: /למותו של/g,
        replaceWith: "למוות של"
    }, {
        matchWith: /כמה שמהר יותר/g,
        replaceWith: "בהקדם האפשרי"
    }, {
        matchWith: /לכול דבר/g,
        replaceWith: "לכל דבר"
    }, {
        matchWith: /אחזור מיד/g,
        replaceWith: "מיד אשוב"
    }, {
        matchWith: /כול דבר/g,
        replaceWith: "כל דבר"
    }, {
        matchWith: /כול יום/g,
        replaceWith: "כל יום"
    }, {
        matchWith: /אני מפציר בך/g,
        replaceWith: "אני מתחנן"
    }, {
        matchWith: /אני מפצירה בך/g,
        replaceWith: "אני מתחננת"
    }, {
        matchWith: /אחוזים/g,
        replaceWith: "אחוז"
    }, {
        matchWith: /דולרים/g,
        replaceWith: "דולר"
    }, {
        matchWith: /ככה זה נראה./g,
        replaceWith: "כך נראה"
    }, {
        matchWith: /סוף-סוף/g,
        replaceWith: "סוף סוף"
    }, {
        matchWith: /בכול רגע/g,
        replaceWith: "בכל רגע"
    }, {
        matchWith: /\.\.\.\?/g,
        replaceWith: "..."
    }, {
        matchWith: /טביעות אצבעות/g,
        replaceWith: "טביעות אצבע"
    }, {
        matchWith: /אותו הדבר/g,
        replaceWith: "אותו דבר"
    }, {
        matchWith: /האחד את השני/g,
        replaceWith: "אחד את השני"
    }, {
        matchWith: /האחד לשני/g,
        replaceWith: "אחד לשני"
    }, {
        matchWith: /טביעות האצבעות/g,
        replaceWith: "טביעות האצבע"
    }, {
        matchWith: /פעם אחרי פעם/g,
        replaceWith: "פעם אחר פעם"
    }, {
        matchWith: /יש לי לעשות המון/g,
        replaceWith: "אני עסוק מאוד"
    }, {
        matchWith: /בטח אתה/g,
        replaceWith: "אתה בטח"
    }, {
        matchWith: /יש לי לומר לך משהו/g,
        replaceWith: "יש לי משהו לומר לך"
    }, {
        matchWith: /ברוך בואך/g,
        replaceWith: "ברוך הבא"
    }, {
        matchWith: /שלא בנוח/g,
        replaceWith: "לא בנוח"
    }, {
        matchWith: /כל רצוני הוא/g,
        replaceWith: "אני רק רוצה"
    }, {
        matchWith: /כל רצוני/g,
        replaceWith: "אני רק רוצה"
    }, {
        matchWith: /מחוסר הכרה/g,
        replaceWith: "חסר הכרה"
    }, {
        matchWith: /ויהיה מה/g,
        replaceWith: "ויהי מה"
    }, {
        matchWith: /תאמרי לי/g,
        replaceWith: "תגידי לי"
    }, {
        matchWith: /תאמר לי/g,
        replaceWith: "תגיד לי"
    }, {
        matchWith: /תשמע אותי/g,
        replaceWith: "תקשיב לי"
    }, {
        matchWith: /תמיד אתה /g,
        replaceWith: "אתה תמיד "
    }, {
        matchWith: /תמיד אני /g,
        replaceWith: "אני תמיד "
    }, {
        matchWith: /תמיד את /g,
        replaceWith: "את תמיד "
    }, {
        matchWith: /תמיד היא /g,
        replaceWith: "היא תמיד "
    }, {
        matchWith: /כפי /g,
        replaceWith: "כמו "
    }, {
        matchWith: /נאמר לי/g,
        replaceWith: "אמרו לי"
    }, {
        matchWith: /מיליוני/g,
        replaceWith: "מיליון"
    }, {
        matchWith: /תאמר/g,
        replaceWith: "תגיד"
    }, {
        matchWith: /לא עדיין/g,
        replaceWith: "עדיין לא"
    }, {
        matchWith: /המן זמן/g,
        replaceWith: "המון זמן"
    }, {
        matchWith: /ידוע לנו/g,
        replaceWith: "אנחנו יודעים"
    }, {
        matchWith: /ידוע לכם/g,
        replaceWith: "אתם יודעים"
    }, {
        matchWith: /ידוע לכן/g,
        replaceWith: "אתן יודעות"
    }, {
        matchWith: /קסטייה/g,
        replaceWith: "קסטיליה"
    }, {
        matchWith: /תחיי המלך/g,
        replaceWith: "יחי המלך"
    }, {
        matchWith: /מיד אחרי ש/g,
        replaceWith: "ברגע ש"
    }, {
        matchWith: /עכשיו מה נעשה/g,
        replaceWith: "מה נעשה עכשיו"
    }, {
        matchWith: /אלפונסו אחיה/g,
        replaceWith: "אחיה אלפונסו"
    }, {
        matchWith: /אלפונסו אחי/g,
        replaceWith: "אחי אלפונסו"
    }, {
        matchWith: /מהלך|מהלכים/g,
        replaceWith: "אסטרטגיה"
    }, {
        matchWith: /מו"מ/g,
        replaceWith: "משא ומתן"
    }, {
        matchWith: /אתה לא בטעם שלי/g,
        replaceWith: "אתה לא הטעם שלי"
    }, {
        matchWith: /מותה|מותו של/g,
        replaceWith: "המוות של"
    }, {
        matchWith: /התור שלך/g,
        replaceWith: "תורך"
    }, {
        matchWith: /ככה יהיה/g,
        replaceWith: "כך יהיה"
    }, {
        matchWith: /יש לי בשבילך משהו/g,
        replaceWith: "יש לי משהו בשבילך"
    }, {
        matchWith: /אנריקז/g,
        replaceWith: "אנריקס"
    }, {
        matchWith: /באטריס/g,
        replaceWith: "ביאטריס"
    }, {
        matchWith: /ככה אעשה/g,
        replaceWith: "כך אעשה"
    }, {
        matchWith: /ככה יהיה/g,
        replaceWith: "כך יהיה"
    }, {
        matchWith: /בטח זה מה שקרה/g,
        replaceWith: "זה בטח מה שקרה"
    }, {
        matchWith: /יש לעשות המון/g,
        replaceWith: "יש הרבה עבודה"
    }, {
        matchWith: /יהיה חסר/g,
        replaceWith: "יחסר"
    }, {
        matchWith: /יהיו חסרים/g,
        replaceWith: "יחסרו"
    }, {
        matchWith: /פרננדו המלך/g,
        replaceWith: "המלך פרננדו"
    }, {
        matchWith: /אלפונסו המלך/g,
        replaceWith: "המלך אלפונסו"
    }, {
        matchWith: /יחי המלכה/g,
        replaceWith: "תחי המלכה"
    }, {
        matchWith: /יחי קסטיליה/g,
        replaceWith: "תחי קסטיליה"
    }, {
        matchWith: /תחיי פרננדו/g,
        replaceWith: "יחי פרננדו"
    }, {
        matchWith: /ככול/g,
        replaceWith: "ככל"
    }, {
        matchWith: /ברירה/g,
        replaceWith: "בררה"
    }, {
        matchWith: /קורבן/g,
        replaceWith: "קרבן"
    }, {
        matchWith: /מאשר אלו/g,
        replaceWith: "מאלו"
    }, {
        matchWith: /מיסים/g,
        replaceWith: "מסים"
    }, {
        matchWith: /דוגמא/g,
        replaceWith: "דוגמה"
    }, {
        matchWith: /תרגום :/g,
        replaceWith: "תרגום:"
    }, {
        matchWith: /לאוהב/g,
        replaceWith: "לאהוב"
    }, {
        matchWith: /רחוקים כמה שיותר/g,
        replaceWith: "כמה שיותר רחוק"
    }, {
        matchWith: /החטא של הבשר/g,
        replaceWith: "חטא הבשר"
    }, {
        matchWith: /הוראות מפורשת/g,
        replaceWith: "הוראות מפורשות"
    }, {
        matchWith: /סיכוים/g,
        replaceWith: "סיכויים"
    }, {
        matchWith: /גרדנה/g,
        replaceWith: "גרנדה"
    }, {
        matchWith: /תחיי /g,
        replaceWith: "תחי "
    }, {
        matchWith: /גיבורותיי/g,
        replaceWith: "גבירותיי"
    }, {
        matchWith: /הספקת אש/g,
        replaceWith: "הפסקת אש"
    }, {
        matchWith: /תנובה/g,
        replaceWith: "תבונה"
    }, {
        matchWith: /אוקיאנוס/g,
        replaceWith: "אוקינוס"
    }, {
        matchWith: /בפרק הקודם של איסבל/g,
        replaceWith: 'בפרק הקודם של "איסבל":'
    }, {
        matchWith: /בפרק הבא באיסבל/g,
        replaceWith: 'בפרק הבא של "איסבל":'
    }, {
        matchWith: /מילאן/g,
        replaceWith: 'מילאנו'
    }, {
        matchWith: /צפרת/g,
        replaceWith: 'צרפת'
    }, {
        matchWith: /כף המוזנים/g,
        replaceWith: 'כף המאזניים'
    }, {
        matchWith: /מחלקות/g,
        replaceWith: 'מחלוקות'
    }, {
        matchWith: /גברת,/g,
        replaceWith: 'גברתי,'
    }, {
        matchWith: /דבר לא יקרה לו/g,
        replaceWith: 'לא יקרה לו כלום'
    }, {
        matchWith: /דבר לא יקרה לה/g,
        replaceWith: 'לא יקרה לה כלום'
    }, {
        matchWith: /לנשות/g,
        replaceWith: 'לשנות'
    }, {
        matchWith: /התחליתי/g,
        replaceWith: 'התחלתי'
    }, {
        matchWith: /תגבורות/g,
        replaceWith: 'תגבורת'
    }, {
        matchWith: /עם צרפת שלום/g,
        replaceWith: 'שלום עם צרפת'
    }, {
        matchWith: /הטוב יותר/g,
        replaceWith: 'הטוב ביותר'
    }, {
        matchWith: /הטובה יותר/g,
        replaceWith: 'הטובה ביותר'
    }, {
        matchWith: /נחזור לבית/g,
        replaceWith: 'נחזור הביתה'
    }, {
        matchWith: /לחזור לבית/g,
        replaceWith: 'לחזור הביתה'
    }, {
        matchWith: /לדואג/g,
        replaceWith: 'לדאוג'
    }, {
        matchWith: /החובה שלה/g,
        replaceWith: 'חובתה'
    }, {
        matchWith: /החובה שלו/g,
        replaceWith: 'חובתו'
    }, {
        matchWith: /את הדרך/g,
        replaceWith: 'דרך'
    }, {
        matchWith: /אנריקה/g,
        replaceWith: 'הנרי'
    }, {
        matchWith: /בלטרנחה/g,
        replaceWith: 'בלטארנחה'
    }, {
        matchWith: /גברת,/g,
        replaceWith: 'גברתי,'
    }, {
        matchWith: /גברת\./g,
        replaceWith: 'גברתי.'
    }, {
        matchWith: /סנטמריה/g,
        replaceWith: 'סנטה מריה'
    }, {
        matchWith: /שיכורה קצת/g,
        replaceWith: 'קצת שיכורה'
    }, {
        matchWith: /שיכור קצת/g,
        replaceWith: 'קצת שיכור'
    }, {
        matchWith: /איסמעל|איסמעיל/g,
        replaceWith: 'איסמאל'
    }, {
        matchWith: /אטון|אוטן/g,
        replaceWith: 'אוטון'
    }, {
        matchWith: /מה השם שלך/g,
        replaceWith: 'איך קוראים לך'
    }, {
        matchWith: /דרך אגב\./g,
        replaceWith: 'דרך אגב,'
    }, {
        matchWith: /וויז'גס/g,
        replaceWith: 'וייגס'
    }, {
        matchWith: /כלפיך טובה/g,
        replaceWith: 'טובה כלפיך'
    }, {
        matchWith: /היגע הזמן/g,
        replaceWith: 'הגיע הזמן'
    }, {
        matchWith: /המאבטחים/g,
        replaceWith: 'שומרי הראש'
    }, {
        matchWith: /מאבטחים/g,
        replaceWith: 'שומרי ראש'
    }, {
        matchWith: /מאבטח/g,
        replaceWith: 'שומר ראש'
    }, {
        matchWith: /ורקרוז/g,
        replaceWith: 'ורקרוס'
    }, {
        matchWith: /רק זה\?/g,
        replaceWith: 'זה הכול?'
    }, {
        matchWith: /בשבילנו זה קשה/g,
        replaceWith: 'זה קשה לנו'
    }, {
        matchWith: /תשמע היטב/g,
        replaceWith: 'תקשיב טוב'
    }, {
        matchWith: /תשמעי היטב/g,
        replaceWith: 'תקשיבי טוב'
    }, {
        matchWith: /תשמעי אותי/g,
        replaceWith: 'תקשיבי לי'
    }, {
        matchWith: /תתקמצני עם/g,
        replaceWith: "תתקמצני על"
    }, {
        matchWith: /איך\?/g,
        replaceWith: "מה?"
    }, {
        matchWith: /צ'וצ'ימילקו/g,
        replaceWith: "סוצ'ימילקו"
    }, {
        matchWith: /מרחקת/g,
        replaceWith: 'מרקחת'
    }, {
        matchWith: /עכשיו מה עשיתי/g,
        replaceWith: 'מה עשיתי הפעם'
    }, {
        matchWith: /מה הייתי אמור/g,
        replaceWith: 'מה אני אמור'
    }, {
        matchWith: /זה יהיה ככה|ככה זה יהיה/g,
        replaceWith: 'כך יהיה'
    }, {
        matchWith: /לנוסע/g,
        replaceWith: 'לנסוע'
    }, {
        matchWith: /לא צלח/g,
        replaceWith: 'לא הצליח'
    }, {
        matchWith: / באמת /g,
        replaceWith: ' '
    }, {
        matchWith: /אנז'י|אנח'י/g,
        replaceWith: "אנג'י"
    }, {
        matchWith: /בנח'י|בנז'י/g,
        replaceWith: "בנג'"
    }, {
        matchWith: /כמעט ואנג'י/g,
        replaceWith: "אנג'י כמעט"
    }, {
        matchWith: /זה כול /g,
        replaceWith: "זה כל "
    }, {
        matchWith: /אוהבי,/g,
        replaceWith: "אהוביץ,"
    }, {
        matchWith: /כמעט ו/g,
        replaceWith: "כמעט "
    }, {
        matchWith: /לסבול שוב/g,
        replaceWith: "לשוב לסבול"
    }, {
        matchWith: /כסף רב/g,
        replaceWith: "הרבה כסף"
    }, {
        matchWith: /צ'יביס|צי'ביס/g,
        replaceWith: "צ'יוויס"
    }, {
        matchWith: /כול מקום/g,
        replaceWith: "כל מקום"
    }, {
        matchWith: /תשמע\./g,
        replaceWith: "תקשיב,"
    }, {
        matchWith: /שאגלה לך משהו\?/g,
        replaceWith: "לגלות לך משהו?"
    }, {
        matchWith: /בכול זאת/g,
        replaceWith: "בכל זאת"
    }, {
        matchWith: /טיטיאנה/g,
        replaceWith: "טטיאננ"
    }, {
        matchWith: /השומר הראש/g,
        replaceWith: "שומר הראש"
    }, {
        matchWith: /זאת הייתה בצחוק/g,
        replaceWith: "זה היה בצחוק"
    }, {
        matchWith: /ל-וילסון/g,
        replaceWith: "לווילסון"
    }, {
        matchWith: /אלף דברים בראש/g,
        replaceWith: "אלף דברים על הראש"
    }, {
        matchWith: /משבר גיל המערב/g,
        replaceWith: "משבר גיל המעבר"
    }, {
        matchWith: /צ'ילקליס/g,
        replaceWith: "צ'ילקילס"
    }, {
        matchWith: /אני לא אשם ש|אני לא אשמה ש/g,
        replaceWith: "זאת לא אשמתי ש"
    }, {
        matchWith: /אני מודאג ממנו/g,
        replaceWith: "אני דואג לו"
    }, {
        matchWith: /פרידה הדודה/g,
        replaceWith: "דודה פרידה"
    }, {
        matchWith: /אני צריך את העזרה שלך/g,
        replaceWith: "אני זקוק לעזרתך"
    }, {
        matchWith: /נתיקה/g,
        replaceWith: "ניתקה"
    }, {
        matchWith: /השומר ראש/g,
        replaceWith: "שומר הראש"
    }, {
        matchWith: /אוגסטין/g,
        replaceWith: "אגוסטין"
    }, {
        matchWith: /טובה הרבה יותר/g,
        replaceWith: "הרבה יותר טובה"
    }, {
        matchWith: /כול אחד/g,
        replaceWith: "כל אחד"
    }, {
        matchWith: /אתה צודק בזה/g,
        replaceWith: "בזה אתה צודק"
    }, {
        matchWith: /צעד-צעד/g,
        replaceWith: "צעד אחר צעד"
    }, {
        matchWith: /כאילו זאת עצובה קצת, לא\?/g,
        replaceWith: "היא קצת עצובה, לא?"
    }, {
        matchWith: /צבע חסר להן/g,
        replaceWith: "חסר להן צבע"
    }, {
        matchWith: /הגורע מכול/g,
        replaceWith: "הגרוע מכול"
    }
].map(Fix.build);    
  
</script>
</head>
<body>
    <div>
        <div id='player' style="float: left;">
            <video src="AMO DESPERTAR CONTIGO 88.MP4" autobuffer height="120px" controls></video>
            <br />
            <input type='number' id='playback-rate-control' />
            <div id="options-section">
                <button onclick='saveBuffer(Editor);'>Save Buffer</button>
                <button onclick="loadBuffer(Editor);">Load Buffer</button>
                <button onclick="loadBufferFromRecovery(Editor);">Load (Recovery)</button>
                <button onclick="fixCommonErrors(Editor);">Fix Common Errors</button>
                <button onclick="finalErrorCheck(Editor)">Final Error Check</button>
            </div>
            <div id="common-errors-area">
                <input id="fix-pattern" type="text" name="fix-pattern" placeholder="Match" style="width:95px;margin-top: 5px;"/>
                <input id="replace-with" type="text" name="replace-with" placeholder="Replace" style="width:95px;margin-top: 5px;"/>
                <br>
                <div style='font-size: 0.7em;margin-top: 3px;'>Common Errors To Highlight</div>
                <select id='common-error-select' style='margin-top: 5px;'>
                </select><br>
                <button id="highlight-matches" style="margin-top: 5px;">Highlight</button> <span id='match-count'></span>
                <div id='error-fix-display-container'>
                
                </div>
                <br>
            </div>
        </div>
        <div id='editor' style="float: left; margin-left: 15px;">
            <textarea cols=30 rows=40 wrap="hard" dir='rtl'
                      style="font-family: 'Courier New', Courier, 'Lucida Sans Typewriter', 'Lucida Typewriter', monospace;"></textarea>
        </div>
        <div id="fixes-section" style="float: left; margin-left: 15px">
        </div>
        <div id='hotkeys-info'>
            <h4>Hotkeys</h4>
            <table>
                <thead>
                    <tr>
                        <th>Key</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><kbd>Alt+&darr; | Alt+&uarr; | Ctrl+Space</kbd></td>
                        <td>Pause</td>
                    </tr>
                    <tr>
                        <td><kbd>Alt+&larr;</kbd></td>
                        <td>Rewind 10 milliseconds</td>
                    </tr>
                    <tr>
                        <td><kbd>Alt+&rarr;</kbd></td>
                        <td>Fastforward 10 milliseconds</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</html>
